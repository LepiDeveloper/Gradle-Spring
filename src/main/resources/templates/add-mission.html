<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Add Missions</title>
  <link rel="stylesheet" th:href="@{/webjars/bootstrap/css/bootstrap.min.css}"/>
  <script defer th:src="@{/webjars/bootstrap/js/bootstrap.bundle.min.js}"> </script>

</head>
<body>
<div th:insert="~{fragments/navbar :: navbar}"></div>



<!-- Form to add a new missions -->
<h1 th:text="#{add.mission.heading}">Add a New Mission</h1>

<div class="container mt-5">
  <h1 class="mb-4" th:text="#{add.mission.heading}">Add a New Mission</h1>

  <form th:action="@{/missions/add}" th:object="${mission}" method="post"
        class="needs-validation" novalidate
        enctype="multipart/form-data">

    <!-- Mission Name -->
    <div class="mb-3">
      <label for="name" class="form-label" th:text="#{mission.name}">Mission Name</label>
      <input type="text" id="name" th:field="*{missionName}" class="form-control" required>
      <!-- Server-side error message -->
      <div class="text-danger" th:if="${#fields.hasErrors('missionName')}"
           th:errors="*{missionName}"></div>
      <!-- Client-side error message -->
      <div class="invalid-feedback">
        Please provide a mission name.
      </div>
    </div>

    <!-- Mission Objective -->
    <div class="mb-3">
      <label for="missionObjective" class="form-label" th:text="#{mission.objective}">Mission Objective</label>
      <input type="text" id="missionObjective" th:field="*{missionObjective}" class="form-control" required>
      <!-- Server-side error message -->
      <div class="text-danger" th:if="${#fields.hasErrors('missionObjective')}"
           th:errors="*{missionObjective}"></div>
      <!-- Client-side error message -->
      <div class="invalid-feedback">
        Please enter the mission objective.
      </div>
    </div>

    <!-- Launch Date -->
    <div class="mb-3">
      <label for="launchDate" class="form-label" th:text="#{mission.launchDate}">Launch Date</label>
      <input type="date" id="launchDate" th:field="*{launchDate}" class="form-control">
      <!-- Server-side error message -->
      <div class="text-danger" th:if="${#fields.hasErrors('launchDate')}"
           th:errors="*{launchDate}"></div>
    </div>

    <!-- Crew On Board -->
    <div class="mb-3">
      <label for="crewOnBoard" class="form-label" th:text="#{mission.crewOnBoard}">Crew On Board</label>
      <input type="number" id="crewOnBoard" th:field="*{crewOnboard}" class="form-control" required>
      <!-- Server-side error message -->
      <div class="text-danger" th:if="${#fields.hasErrors('crewOnboard')}"
           th:errors="*{crewOnboard}"></div>
      <!-- Client-side error message -->
      <div class="invalid-feedback">
        Please enter the crew count.
      </div>
    </div>

    <!-- Successful -->
    <div class="form-check mb-3">
      <input type="checkbox" id="isSuccess" th:field="*{success}" class="form-check-input">
      <label class="form-check-label" for="isSuccess" th:text="#{mission.isSuccess}">Is it Successful</label>
    </div>

    <!-- Mission Type -->
    <div class="mb-4">
      <label for="missionType" class="form-label" th:text="#{mission.type}">Mission Type</label>
      <select id="missionType" th:field="*{missionType}" class="form-select" required>
        <option value="" disabled selected>Select a mission type</option>
        <option th:each="type : ${missionTypes}" th:value="${type}" th:text="${type}"></option>
      </select>
      <!-- Server-side error message -->
      <div class="text-danger" th:if="${#fields.hasErrors('missionType')}"
           th:errors="*{missionType}"></div>
      <!-- Client-side error message -->
      <div class="invalid-feedback">
        Please select a mission type.
      </div>
    </div>

    <!-- Launch Site -->
    <div class="mb-3">
      <label for="launchSite" class="form-label">Launch Site</label>
      <select id="launchSite" th:field="*{launchSite}" class="form-select" required>
        <option value="" disabled selected>Select a launch site</option>
        <option th:each="site : ${launchSites}" th:value="${site.siteId}" th:text="${site.siteName}"></option>
      </select>
    </div>

    <!-- Rockets -->
    <div class="mb-3">
      <label for="rockets" class="form-label">Rockets</label>
      <select id="rockets" th:field="*{rockets}" class="form-select" multiple>
        <option th:each="rocket : ${rockets}" th:value="${rocket.rocketId}" th:text="${rocket.rocketName}"></option>
      </select>
    </div>

    <!-- Image Upload -->
    <div class="mb-3">
      <label for="imageFile" class="form-label">Mission Image</label>
      <input type="file" id="imageFile" th:field="*{imageFile}" class="form-control" accept="image/*">
    </div>

    <!-- Submit -->
    <button type="submit" class="btn btn-primary" th:text="#{form.submit}">Submit</button>
  </form>
</div>

<div th:insert="~{fragments/navbar :: footer}"></div>

<script>
  (() => {
    'use strict';
    const forms = document.querySelectorAll('.needs-validation');
    Array.from(forms).forEach(form => {
      form.addEventListener('submit', event => {
        if (!form.checkValidity()) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  })();
</script>
</body>
</html>